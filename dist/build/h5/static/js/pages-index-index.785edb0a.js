(self["webpackChunkcloud_stock"]=self["webpackChunkcloud_stock"]||[]).push([[329],{146:function(t,a,e){"use strict";e.d(a,{FF:function(){return s},SR:function(){return n},t7:function(){return o}});var i=e(132);const s=(t={})=>(0,i.A)({url:"/stock/item/list",method:"GET",params:t}),o=t=>(0,i.A)({url:"/stock/buy",method:"PUT",data:t}),n=()=>(0,i.A)({url:"/stock/user",method:"GET"})},160:function(t,a,e){var i=e(980);i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);var s=e(583).A;s("1a63f929",i,!0,{sourceMap:!1,shadowMode:!1})},865:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return b}});var i,s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"container"},[e("v-uni-view",{staticClass:"header-card"},[e("v-uni-view",{staticClass:"title-box"},[e("v-uni-text",{staticClass:"title"},[t._v("官方市场")]),e("v-uni-view",{staticClass:"status-badge"},[e("v-uni-text",{staticClass:"status-dot"}),e("v-uni-text",[t._v("赛前申购阶段")])],1)],1),e("v-uni-text",{staticClass:"subtitle"},[t._v("这里展示所有官方立项的项目，您可以直接申购原始股。")])],1),e("v-uni-view",{staticClass:"stock-list"},t._l(t.list,function(a,i){return e("v-uni-view",{key:a.id||i,staticClass:"stock-card",class:{"disabled-card":2===a.status}},[e("v-uni-view",{staticClass:"card-header"},[e("v-uni-view",{staticClass:"header-left"},[e("u-icon",{attrs:{name:"grid-fill",color:"#2979ff",size:"24"}}),e("v-uni-text",{staticClass:"item-name"},[t._v(t._s(a.name))])],1),e("u-tag",{attrs:{text:t.getStatusText(a.status),type:t.getStatusType(a.status),shape:"circle",size:"mini"}})],1),e("v-uni-view",{staticClass:"card-body"},[e("v-uni-text",{staticClass:"item-desc"},[t._v(t._s(a.description||"暂无项目描述"))]),e("v-uni-view",{staticClass:"data-grid"},[e("v-uni-view",{staticClass:"data-item"},[e("v-uni-text",{staticClass:"value price"},[t._v(t._s(a.purchasePrice))]),e("v-uni-text",{staticClass:"label"},[t._v("进货价")])],1),e("v-uni-view",{staticClass:"data-item"},[e("v-uni-text",{staticClass:"value"},[t._v(t._s(a.totalValue))]),e("v-uni-text",{staticClass:"label"},[t._v("当前总值")])],1),e("v-uni-view",{staticClass:"data-item"},[e("v-uni-text",{staticClass:"value"},[t._v(t._s(a.totalQuantity))]),e("v-uni-text",{staticClass:"label"},[t._v("发行总量")])],1)],1)],1),e("v-uni-view",{staticClass:"card-footer"},[e("v-uni-view",{staticClass:"valuation"},[t._v(" 估值: "),e("v-uni-text",{staticClass:"highlight"},[t._v(t._s((a.totalValue/(a.totalQuantity||1)).toFixed(2)))])],1),1===a.status?e("u-button",{attrs:{type:"primary",text:"立即申购",size:"small",shape:"circle",customStyle:"padding: 0 20px; height: 32px;"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openBuyModal(a)}}}):e("u-button",{attrs:{type:"info",text:"停止申购",size:"small",shape:"circle",disabled:!0,plain:!0}})],1)],1)}),1),0===t.list.length?e("u-empty",{attrs:{mode:"data",icon:"http://cdn.uviewui.com/uview/empty/data.png",text:"暂无项目数据"}}):t._e(),e("u-modal",{attrs:{show:t.showBuyModal,title:"申购股票",showCancelButton:!0,confirmColor:"#2979ff"},on:{confirm:function(a){arguments[0]=a=t.$handleEvent(a),t.handleBuy.apply(void 0,arguments)},cancel:function(a){arguments[0]=a=t.$handleEvent(a),t.showBuyModal=!1}}},[e("v-uni-view",{staticClass:"modal-content"},[e("v-uni-view",{staticClass:"project-info"},[e("v-uni-view",{staticClass:"info-row"},[e("v-uni-text",{staticClass:"label"},[t._v("当前项目")]),e("v-uni-text",{staticClass:"val"},[t._v(t._s(t.currentItem.name))])],1),e("v-uni-view",{staticClass:"info-row"},[e("v-uni-text",{staticClass:"label"},[t._v("原始单价")]),e("v-uni-text",{staticClass:"val price"},[t._v(t._s(t.currentItem.purchasePrice)+" 幸运值")])],1)],1),e("v-uni-view",{staticClass:"input-box"},[e("u-input",{attrs:{placeholder:"请输入购买数量",type:"number",border:"surround",clearable:!0,shape:"circle"},model:{value:t.buyQuantity,callback:function(a){t.buyQuantity=a},expression:"buyQuantity"}})],1),t.buyQuantity?e("v-uni-view",{staticClass:"summary-box"},[e("v-uni-text",[t._v("预计花费")]),e("v-uni-text",{staticClass:"total-price"},[t._v(t._s(t.buyQuantity*t.currentItem.purchasePrice)+" 幸运值")])],1):t._e()],1)],1)],1)},o=[],n={},c=e(146),l={data(){return{list:[],timer:null,showBuyModal:!1,currentItem:{},buyQuantity:""}},onShow(){this.fetchList(),this.startPolling()},onHide(){this.stopPolling()},onPullDownRefresh(){this.fetchList().finally(()=>{uni.stopPullDownRefresh()})},methods:{async fetchList(){try{const t=await(0,c.FF)();0===t.code&&t.data&&(this.list=t.data.list||[])}catch(t){console.error(t)}},startPolling(){this.stopPolling(),this.timer=setInterval(()=>{this.fetchList()},1e4)},stopPolling(){this.timer&&(clearInterval(this.timer),this.timer=null)},getStatusText(t){const a={1:"立项中",2:"已淘汰",3:"游戏中",4:"已结算"};return a[t]||"未知"},getStatusType(t){return 1===t?"success":3===t?"warning":2===t?"error":"info"},openBuyModal(t){this.currentItem=t,this.buyQuantity="",this.showBuyModal=!0},async handleBuy(){if(!this.buyQuantity||this.buyQuantity<=0)return uni.showToast({title:"请输入有效数量",icon:"none"}),void(this.showBuyModal=!1);try{const t=await(0,c.t7)({itemId:this.currentItem.id,quantity:Number(this.buyQuantity)});0===t.code?(uni.showToast({title:"申购成功",icon:"success"}),this.showBuyModal=!1,this.fetchList(),this.$store.dispatch("updateUserInfo")):(uni.showToast({title:t.message||t.msg||"申购失败",icon:"none"}),this.showBuyModal=!1)}catch(t){this.showBuyModal=!1}}}},r=l,d=(e(160),e(535)),u=(0,d.A)(r,s,o,!1,null,"1c22a03a",null,!1,n,i),b=u.exports},980:function(t,a,e){"use strict";e.r(a);var i=e(935),s=e.n(i),o=e(56),n=e.n(o),c=n()(s());c.push([t.id,".container[data-v-1c22a03a]{padding:16px;background-color:#f5f7fa;min-height:100vh}.header-card[data-v-1c22a03a]{padding:20px;background:-webkit-linear-gradient(315deg,#2979ff,#609cff);background:linear-gradient(135deg,#2979ff,#609cff);border-radius:16px;margin-bottom:20px;color:#fff;box-shadow:0 4px 12px rgba(41,121,255,.3)}.header-card .title-box[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-bottom:8px}.header-card .title-box .title[data-v-1c22a03a]{font-size:22px;font-weight:800;letter-spacing:.5px}.header-card .title-box .status-badge[data-v-1c22a03a]{background-color:hsla(0,0%,100%,.2);padding:4px 10px;border-radius:20px;font-size:12px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.header-card .title-box .status-badge .status-dot[data-v-1c22a03a]{width:6px;height:6px;background-color:#19be6b;border-radius:50%;margin-right:6px}.header-card .subtitle[data-v-1c22a03a]{font-size:13px;opacity:.9;line-height:1.4}.stock-list .stock-card[data-v-1c22a03a]{background-color:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 2px 8px rgba(0,0,0,.04);-webkit-transition:all .2s;transition:all .2s}.stock-list .stock-card.disabled-card[data-v-1c22a03a]{opacity:.7;background-color:#fafafa}.stock-list .stock-card .card-header[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;margin-bottom:12px;padding-bottom:12px;border-bottom:1px solid #f0f2f5}.stock-list .stock-card .card-header .header-left[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;gap:8px}.stock-list .stock-card .card-header .header-left .item-name[data-v-1c22a03a]{font-size:16px;font-weight:700;color:#303133}.stock-list .stock-card .card-body .item-desc[data-v-1c22a03a]{font-size:13px;color:#909399;margin-bottom:16px;display:block;line-height:1.5}.stock-list .stock-card .card-body .data-grid[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;background-color:#f9fafe;padding:12px;border-radius:8px;margin-bottom:16px}.stock-list .stock-card .card-body .data-grid .data-item[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-flex:1;-webkit-flex:1;flex:1}.stock-list .stock-card .card-body .data-grid .data-item .label[data-v-1c22a03a]{font-size:11px;color:#909399;margin-top:4px}.stock-list .stock-card .card-body .data-grid .data-item .value[data-v-1c22a03a]{font-size:15px;color:#303133;font-weight:600}.stock-list .stock-card .card-body .data-grid .data-item .value.price[data-v-1c22a03a]{color:#2979ff}.stock-list .stock-card .card-footer[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.stock-list .stock-card .card-footer .valuation[data-v-1c22a03a]{font-size:12px;color:#606266}.stock-list .stock-card .card-footer .valuation .highlight[data-v-1c22a03a]{color:#f90;font-weight:700;margin-left:4px;font-size:14px}.modal-content[data-v-1c22a03a]{padding:10px 0}.modal-content .project-info[data-v-1c22a03a]{background-color:#f9fafe;padding:12px;border-radius:8px;margin-bottom:20px}.modal-content .project-info .info-row[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;margin-bottom:8px;font-size:14px}.modal-content .project-info .info-row[data-v-1c22a03a]:last-child{margin-bottom:0}.modal-content .project-info .info-row .label[data-v-1c22a03a]{color:#909399}.modal-content .project-info .info-row .val[data-v-1c22a03a]{font-weight:500;color:#303133}.modal-content .project-info .info-row .val.price[data-v-1c22a03a]{color:#2979ff}.modal-content .input-box[data-v-1c22a03a]{margin-bottom:20px}.modal-content .summary-box[data-v-1c22a03a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding-top:10px;border-top:1px dashed #e4e7ed;font-size:14px}.modal-content .summary-box .total-price[data-v-1c22a03a]{color:#f56c6c;font-weight:700;font-size:16px}",""]),a["default"]=c}}]);